---
title: "Технический вызов: Отладка связи контроллера и \"агента\" GPT"
date: 2025-03-19T10:00:00+03:00
draft: false
tags: ["разработка", "трудности", "hardware", "software", "GPT", "МАС", "отладка"]
author: "Мукабенов Дмитрий Олегович"
---

# Когда "железо" встречается с ИИ: Первые трудности

![Паяльник, провода, код на экране](/images/hw-sw-debug.jpg)
*Отладка взаимодействия контроллера STM32 и программных агентов*

Разработка на стыке hardware и software всегда полна вызовов, а когда добавляется ИИ – становится еще интереснее. На этой неделе мы столкнулись с первыми трудностями при попытке наладить взаимодействие между нашим контроллером STM32 и первыми прототипами программных агентов, включая "агента", использующего GPT.

**В чем была проблема?**

Мы хотели реализовать простую функцию: при возникновении ошибки на аппаратном уровне (например, сигнал с датчика тока о заклинивании щетки), контроллер STM32 отправляет код ошибки на сервер, где "GPT-агент" генерирует понятное для пользователя сообщение об ошибке для вывода на будущий дисплей (Шаг 5 - Индикация ошибок).

Проблемы возникли на нескольких уровнях:

1.  **Передача данных:** Настроить стабильную передачу данных (пока через UART-USB для отладки) с STM32 на ПК, где работает "агент", оказалось не так просто – мешали шумы и ошибки формата.
2.  **Интерпретация GPT:** GPT-агент не всегда корректно интерпретировал код ошибки или добавлял лишнюю информацию, что мешало бы выводу на простой дисплей.
3.  **Задержки:** Ответ от GPT занимал время, что могло быть критично для быстрой реакции системы.

**Как решали:**

*   **Отладка связи:** Использовали логический анализатор для отладки UART, подобрали оптимальную скорость и формат передачи.
*   **Улучшение промпта GPT:** Доработали промпт для GPT-агента, указав строго генерировать только текст сообщения и ничего больше, привели примеры.
*   **Локальный "агент-интерпретатор":** Создали простого программного агента-посредника, который получает код ошибки от STM32, проверяет его по локальной базе известных ошибок, и только если ошибка неизвестна или требует сложного описания – обращается к GPT-агенту. Это снизило задержки для частых ошибок.

**Решение (промежуточное):**

Связка STM32 → Агент-Интерпретатор (локальный) → GPT-Агент (для сложных случаев) заработала стабильнее. Это позволило нам получить первый опыт интеграции hardware, software и ИИ.

**Вывод:** Интеграция физического мира (датчики, контроллер) с миром ИИ (GPT) требует тщательной отладки на всех уровнях. Использование промежуточных локальных агентов может быть хорошей стратегией для повышения надежности и скорости. 