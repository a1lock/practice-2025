---
title: "Проектируем \"железо\" и алгоритмы: STM32, H-мосты и блок-схемы"
date: 2025-03-12T10:00:00+03:00
draft: false
tags: ["hardware", "алгоритмы", "STM32", "электроника", "схемы", "МАС", "проектирование"]
author: "Мукабенов Дмитрий Олегович"
---

# От концепции к "железу" и логике

![Электронная схема и блок-схема на экране](/images/hw-algorithms-design.jpg)
*Проектируем аппаратную часть и продумываем алгоритмы работы*

Этот спринт был посвящен "сердцу" и "мозгу" нашего аппарата: проектированию аппаратной платформы (Шаг 3) и разработке алгоритмов работы (Шаг 4). Параллельно мы думали, как концепции МАС могут помочь структурировать эту работу.

**Проектирование аппаратной платформы (Шаг 3):**

*   **Контроллер:** Выбрали **STM32F4**. Он достаточно мощный, имеет много периферии (ADC для аналоговых датчиков, GPIO для цифровых и энкодера) и считается надежным решением. (Дима)
*   **Силовые цепи:** Продумали подключение основных исполнительных механизмов:
    *   Двигатели щеток → H-мост **L298N** (проверенное решение для управления моторами).
    *   ТЭНы (нагреватели) → Твердотельное реле **SSR** (для коммутации больших нагрузок).
    *   Насосы → Обычные электромеханические реле. (Дима)
*   **Подключение датчиков:** Спланировали, как аналоговые (термопара) и цифровые (энкодер, поплавок) датчики будут подключаться к ADC и GPIO контроллера.
*   **Защита:** Предусмотрели базовую защиту: предохранители и TVS-диоды от скачков напряжения. (Дима)
*   **Моделирование связей (МАС-идея):** Использовали наш прототип "Агента-Требований" и создали "Агента-Компонентов". Теперь при выборе компонента (например, L298N) агент проверяет, соответствует ли он требованиям (например, по току двигателя), заданным в "Агенте-Требований". Это помогает отлавливать несоответствия на раннем этапе.

**Разработка алгоритмов работы (Шаг 4):**

*   **Блок-схемы:** Создали детальные блок-схемы для основного цикла мойки (заполнение, нагрев, вращение щеток, слив) и цикла сушки (вентилятор, прогрев, контроль влажности - опционально для MVP). (Георгий, Дима)
*   **Аварийные ситуации:** Описали алгоритмы реакции на сигналы датчиков (прерывание цикла, отключение нагрузок, сохранение ошибки в EEPROM).
*   **Логика режимов:** Написали псевдокод (и пример на C, как в вашем отчете) для переключения параметров (температура, скорость щеток) в зависимости от выбранного режима (резиновый/текстильный ковер). (Дима)

**Результаты:**

У нас есть четкое представление об аппаратной части и логике работы MVP. Прототипы агентов МАС помогают нам лучше структурировать информацию и отслеживать зависимости между требованиями и компонентами.

Следующий шаг – разработка и проектирование пользовательского интерфейса (Шаг 5) и начало сборки первого hardware-прототипа на макетной плате.
